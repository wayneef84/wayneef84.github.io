<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a0b2e">
    <title>Dad's Slots v3.0</title>
    
    <link rel="stylesheet" href="css/slots.css?v=3.1">
    <link rel="manifest" href="manifest.json">
</head>
<body>

    <div id="gameScaler">

        <div class="game-wrapper">

            <div id="toastContainer" class="toast-container"></div>

            <div class="bolt tl">‚ú¶</div>
            <div class="bolt tr">‚ú¶</div>
            <div class="bolt bl">‚ú¶</div>
            <div class="bolt br">‚ú¶</div>

            <div class="top-bar">
                <button class="sys-btn" onclick="toggleRules()">‚ÑπÔ∏è RULES</button>
                <select id="themeSelector" class="theme-select" onchange="changeTheme(this.value)"></select>
                <button id="audioButton" class="sys-btn" onclick="toggleAudio()">üîä</button>
                <button id="debugButton" class="sys-btn" onclick="toggleDebug()" title="Debug Info">üîß</button>
                <button class="sys-btn warning" onclick="window.location.href='../../index.html'">üè†</button>
            </div>

            <!-- Debug Overlay -->
            <div id="debugOverlay" style="display: none; position: absolute; top: 60px; left: 10px; background: rgba(0,0,0,0.8); color: #0f0; padding: 10px; font-family: monospace; font-size: 12px; border: 1px solid #0f0; border-radius: 4px; z-index: 9999;">
                <div><strong>DEBUG INFO</strong></div>
                <div>Mode: <span id="debugMode">Desktop</span></div>
                <div>Render: <span id="debug3D">3D</span></div>
                <div>FPS: <span id="debugFPS">60</span></div>
                <div>Target: <span id="debugTargetFPS">60</span></div>
                <div>Shadows: <span id="debugShadows">ON</span></div>
                <div>Particles: <span id="debugParticles">0</span></div>
                <div>Win Lines: <span id="debugWinLines">0</span></div>
                <div>Spinning: <span id="debugSpinning">NO</span></div>
            </div>

            <div class="header">
                <div class="stats-box">
                    <div class="label">BALANCE</div>
                    <div id="coinCount" class="value highlight">$100.00</div>
                </div>
                <div class="stats-box">
                    <div class="label">TOTAL WON</div>
                    <div id="totalWon" class="value">$0.00</div>
                </div>
            </div>

            <div class="game-container">
                <!-- Marquee Lights Top Cabinet -->
                <div class="marquee-lights">
                    <div class="marquee-title">SLOTS</div>
                    <div class="light-strip">
                        <div class="light"></div>
                        <div class="light"></div>
                        <div class="light"></div>
                        <div class="light"></div>
                        <div class="light"></div>
                        <div class="light"></div>
                        <div class="light"></div>
                        <div class="light"></div>
                    </div>
                </div>

                <canvas id="slotCanvas"></canvas>
                <div id="winOverlay" class="win-overlay"></div>

                <!-- Bonus Overlay -->
                <div id="bonusOverlay" class="bonus-overlay" style="display: none;">
                    <div class="bonus-content">
                        <h2>BONUS ROUND</h2>
                        <div id="bonusCounter">SPIN 1 OF 10</div>
                        <div id="bonusWinDisplay">TOTAL WON: $0.00</div>
                        <button id="skipBonusButton" class="sys-btn" onclick="skipBonus()">SKIP TO RESULT ‚è©</button>
                    </div>
                </div>

                <div id="bonusIndicator" class="bonus-indicator"></div>

                <!-- Mechanical Frame Overlay -->
                <div class="mechanical-frame">
                    <div class="frame-top"></div>
                    <div class="frame-left"></div>
                    <div class="frame-right"></div>
                    <div class="frame-bottom-left"></div>
                    <div class="frame-bottom-right"></div>
                    <div class="reel-divider" style="left: 20%;"></div>
                    <div class="reel-divider" style="left: 40%;"></div>
                    <div class="reel-divider" style="left: 60%;"></div>
                    <div class="reel-divider" style="left: 80%;"></div>
                    <div class="glass-reflection"></div>
                </div>

                <!-- Physical Slot Machine Lever -->
                <div class="slot-lever">
                    <div class="lever-ball"></div>
                    <div class="lever-arm"></div>
                    <div class="lever-base"></div>
                </div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <button class="circle-btn" onclick="changeBet(-0.50)">‚àí</button>
                    <div class="display-panel">
                        <span class="label">BET</span>
                        <span id="betAmount">$1.00</span>
                    </div>
                    <button class="circle-btn" onclick="changeBet(0.50)">+</button>
                </div>

                <button id="spinButton" class="spin-btn" onclick="spin()">SPIN</button>

                <div class="control-group">
                    <button class="circle-btn" onclick="changePaylines(-1)">‚àí</button>
                    <div class="display-panel">
                        <span class="label">LINES</span>
                        <span id="paylineCount">20</span>
                    </div>
                    <button class="circle-btn" onclick="changePaylines(1)">+</button>
                </div>
            </div>

            <div id="rulesModal" class="modal-overlay" onclick="toggleRules()">
                <div class="modal-content" onclick="event.stopPropagation()">
                    <div class="modal-header">
                        <h2>PAYTABLE</h2>
                        <button class="close-btn" onclick="toggleRules()">√ó</button>
                    </div>
                    <div id="paytableContent" class="modal-body"></div>
                    <div class="modal-footer">
                        <p>Wilds (W) substitute for all symbols except Scatters.</p>
                    </div>
                </div>
            </div>

        </div> </div> <script src="js/slots_audio.js?v=3.1"></script>
    <script src="js/themes.js?v=3.1"></script>
    <script src="js/slots.js?v=3.1"></script>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    }, err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>

</body>
</html>